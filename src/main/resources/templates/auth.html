<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" th:fragment="template (head, body, scripts)">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        if (window.Telegram.WebApp && window.Telegram.WebApp.initData) {
            /* <![CDATA[ */
            var cookieOptions;

            /*[[${#arrays.contains(@environment.activeProfiles, 'production')}]]*/
            cookieOptions = 'path=/; Secure; SameSite=Lax; Max-Age=3600';
            /*[/[[${#arrays.contains(@environment.activeProfiles, 'production')}]]*/

            /*[[${!#arrays.contains(@environment.activeProfiles, 'production')}]]*/
            cookieOptions = 'path=/; SameSite=Lax; Max-Age=3600';
            /*[/[[${!#arrays.contains(@environment.activeProfiles, 'production')}]]*/

            document.cookie = `initData=${window.Telegram.WebApp.initData}; ${cookieOptions}`;
            /* ]]> */
            const urlParams = new URLSearchParams(window.location.search);
            window.location.href = urlParams.get('redirect') || '/';

        } else {
            window.location.href = '/not-in-telegram';  // Если приложение не в Telegram
        }
    });
</script>
</body>
</html>